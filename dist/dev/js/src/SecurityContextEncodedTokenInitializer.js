"use strict";
var TokenParser_1 = require('./Tokens/Parsers/TokenParser');
var IdentityFactory_1 = require('./Identities/IdentityFactory');
var Identity_1 = require('./Identities/Identity');
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = SecurityContextEncodedTokenInitializer;
var SecurityContextEncodedTokenInitializer = (function () {
    function SecurityContextEncodedTokenInitializer(encodedTokens) {
        this.encodedTokens = encodedTokens;
    }
    SecurityContextEncodedTokenInitializer.prototype.Initialize = function (securityContext) {
        var decodedTokensContent = this.encodedTokens.map(function (encodedToken) {
            var tokenParser = new TokenParser_1.default(encodedToken);
            var tokenParsed = tokenParser.Parse();
            var tokenContent = tokenParsed.contentJSON;
            return tokenContent;
        });
        var userCreated = IdentityFactory_1.default.Create(Identity_1.default, decodedTokensContent);
        securityContext.Principal.Identity = userCreated;
    };
    return SecurityContextEncodedTokenInitializer;
}());

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9TZWN1cml0eUNvbnRleHRFbmNvZGVkVG9rZW5Jbml0aWFsaXplci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBR0EsNEJBQXdCLDhCQUE4QixDQUFDLENBQUE7QUFDdkQsZ0NBQTRCLDhCQUE4QixDQUFDLENBQUE7QUFDM0QseUJBQXFCLHVCQUF1QixDQUFDLENBQUE7QUFFN0M7a0JBQWUsc0NBQXNDLENBQUM7QUFFdEQ7SUFFSSxnREFBbUIsYUFBdUI7UUFBdkIsa0JBQWEsR0FBYixhQUFhLENBQVU7SUFHMUMsQ0FBQztJQUVNLDJEQUFVLEdBQWpCLFVBQWtCLGVBQWdDO1FBRTlDLElBQUksb0JBQW9CLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsVUFBQyxZQUFZO1lBRTNELElBQUksV0FBVyxHQUFHLElBQUkscUJBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUNoRCxJQUFJLFdBQVcsR0FBRyxXQUFXLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDdEMsSUFBSSxZQUFZLEdBQUcsV0FBVyxDQUFDLFdBQVcsQ0FBQztZQUMzQyxNQUFNLENBQUMsWUFBWSxDQUFDO1FBQ3hCLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxXQUFXLEdBQUcseUJBQWUsQ0FBQyxNQUFNLENBQUMsa0JBQVEsRUFBRSxvQkFBb0IsQ0FBQyxDQUFDO1FBQ3pFLGVBQWUsQ0FBQyxTQUFTLENBQUMsUUFBUSxHQUFHLFdBQVcsQ0FBQztJQUNyRCxDQUFDO0lBQ0wsNkNBQUM7QUFBRCxDQXBCQSxBQW9CQyxJQUFBIiwiZmlsZSI6InNyYy9TZWN1cml0eUNvbnRleHRFbmNvZGVkVG9rZW5Jbml0aWFsaXplci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTZWN1cml0eUNvbnRleHQgZnJvbSAnLi9TZWN1cml0eUNvbnRleHQnO1xyXG5pbXBvcnQgSVNlY3VyaXR5Q29udGV4dEluaXRpYWxpemVyIGZyb20gJy4vSVNlY3VyaXR5Q29udGV4dEluaXRpYWxpemVyJztcclxuXHJcbmltcG9ydCBUb2tlblBhcnNlciBmcm9tICcuL1Rva2Vucy9QYXJzZXJzL1Rva2VuUGFyc2VyJztcclxuaW1wb3J0IElkZW50aXR5RmFjdG9yeSBmcm9tICcuL0lkZW50aXRpZXMvSWRlbnRpdHlGYWN0b3J5JztcclxuaW1wb3J0IElkZW50aXR5IGZyb20gJy4vSWRlbnRpdGllcy9JZGVudGl0eSc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTZWN1cml0eUNvbnRleHRFbmNvZGVkVG9rZW5Jbml0aWFsaXplcjtcclxuXHJcbmNsYXNzIFNlY3VyaXR5Q29udGV4dEVuY29kZWRUb2tlbkluaXRpYWxpemVyIGltcGxlbWVudHMgSVNlY3VyaXR5Q29udGV4dEluaXRpYWxpemVyXHJcbntcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBlbmNvZGVkVG9rZW5zIDpzdHJpbmdbXSkgXHJcbiAgICB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHB1YmxpYyBJbml0aWFsaXplKHNlY3VyaXR5Q29udGV4dCA6U2VjdXJpdHlDb250ZXh0KVxyXG4gICAge1xyXG4gICAgICAgIGxldCBkZWNvZGVkVG9rZW5zQ29udGVudCA9IHRoaXMuZW5jb2RlZFRva2Vucy5tYXAoKGVuY29kZWRUb2tlbikgPT5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGxldCB0b2tlblBhcnNlciA9IG5ldyBUb2tlblBhcnNlcihlbmNvZGVkVG9rZW4pO1xyXG4gICAgICAgICAgICBsZXQgdG9rZW5QYXJzZWQgPSB0b2tlblBhcnNlci5QYXJzZSgpO1xyXG4gICAgICAgICAgICBsZXQgdG9rZW5Db250ZW50ID0gdG9rZW5QYXJzZWQuY29udGVudEpTT047XHJcbiAgICAgICAgICAgIHJldHVybiB0b2tlbkNvbnRlbnQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHVzZXJDcmVhdGVkID0gSWRlbnRpdHlGYWN0b3J5LkNyZWF0ZShJZGVudGl0eSwgZGVjb2RlZFRva2Vuc0NvbnRlbnQpO1xyXG4gICAgICAgIHNlY3VyaXR5Q29udGV4dC5QcmluY2lwYWwuSWRlbnRpdHkgPSB1c2VyQ3JlYXRlZDtcclxuICAgIH1cclxufVxyXG4iXX0=
