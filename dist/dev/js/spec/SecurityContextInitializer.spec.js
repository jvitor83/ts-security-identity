(function (factory) {
    if (typeof module === "object" && typeof module.exports === "object") {
        var v = factory(require, exports);
        if (v !== undefined) module.exports = v;
    }
    else if (typeof define === "function" && define.amd) {
        define(["require", "exports", "../src/SecurityContext", "../src/SecurityContextInitializer"], factory);
    }
})(function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var SecurityContext_1 = require("../src/SecurityContext");
    var SecurityContextInitializer_1 = require("../src/SecurityContextInitializer");
    describe('SecurityContextInitializer', function () {
        var encodedAccessToken = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6ImEzck1VZ01Gdjl0UGNsTGE2eUYzekFrZnF1RSIsIng1dCI6ImEzck1VZ01Gdjl0UGNsTGE2eUYzekFrZnF1RSJ9.eyJpc3MiOiJodHRwczovL3BqbXRzdHMvIiwiYXVkIjoiaHR0cHM6Ly9wam10c3RzL3Jlc291cmNlcyIsImV4cCI6MTQ2MTg4NjIzNSwibmJmIjoxNDYxODgyNjM1LCJjbGllbnRfaWQiOiIyMzgwIiwic2NvcGUiOlsib3BlbmlkIiwicHJvZmlsZSIsImVtYWlsIiwicGptdF9wcm9maWxlIiwicGVybWlzc2FvXzIzODAiXSwic3ViIjoiMTY4NDMiLCJhdXRoX3RpbWUiOjE0NjExNjQ5MzIsImlkcCI6Imlkc3J2IiwicGVybWlzc2FvfDIzODA6RGFzaGJvYXJkIjoiQWNlc3NvIiwicGVybWlzc2FvfDIzODA6RGFzaGJvYXJkLkdyYWZpY29zIjoiQWNlc3NvIiwicGVybWlzc2FvfDIzODA6RGFzaGJvYXJkLkdyYWZpY29zLkRpdmVyc29zIjoiQWNlc3NvIiwicGVybWlzc2FvfDIzODA6RGFzaGJvYXJkLkdyYWZpY29zLlNvYnJlIjoiQWNlc3NvIiwicGVybWlzc2FvfDIzODA6RGFzaGJvYXJkLlJlbGF0b3Jpby5SZWxhdG9yaW9DcmlhY2FvIjoiQWNlc3NvIiwicGVybWlzc2FvfDIzODA6RGFzaGJvYXJkLlJlbGF0b3Jpb3MuUmVsYXRvcmlvQWNlc3NvcyI6WyJBY2Vzc28iLCJBbHRlcmFyIiwiRXhjbHVpciIsIk5vdm8iXSwicGVybWlzc2FvfDIzODA6SG9tZSI6IkFjZXNzbyIsInBlcm1pc3Nhb3wyMzgwOk5vdGljaWFzIjoiQWNlc3NvIiwicGVybWlzc2FvfDIzODA6UmVsYXRvcmlvcyI6IkFjZXNzbyIsImFtciI6WyJwYXNzd29yZCJdfQ.Eg-bdPAHKMIDlVMiGNJxEJ9zqth2UmU-k0Ek1BIthC6WKnfyFOQ7EQXIbQGBrLhm4CHr_siwrgThAL5Nq3GJAo0_wxfjgdgt965FHZLO0Xa-QRTvfWdwCU7_jHYjlwuyJ8IDiEpQf6y6eeUIMxRI0JZa-aIrt5MtMCrMMecTdURXF91bXBFdNDJSGLpqrf687HuzUCHrrznBr6wO-5-5Y24rnpTbEclS9KDJYuTZoBQA6-Tkcy_XBHg4c1whwwORf9Nfv1c8_V6ZjML1eiqdlK7MDjqmsZbAZkScrJzZmxpoBMkvAMDIhkmB8ZVsGkrYICqtrAR6BIuTk2aK3z8low";
        var accessToken = JSON.parse("{\"iss\":\"https://pjmtsts/\",\"aud\":\"https://pjmtsts/resources\",\"exp\":1462403582,\"nbf\":1462399982,\"client_id\":\"2380\",\"scope\":[\"openid\",\"profile\",\"pjmt_profile\",\"email\",\"permissao_2380\"],\"sub\":\"16843\",\"auth_time\":1462397042,\"idp\":\"idsrv\",\"permissao|2380:Dashboard\":\"Acesso\",\"permissao|2380:Dashboard.Graficos\":\"Acesso\",\"permissao|2380:Dashboard.Graficos.Diversos\":\"Acesso\",\"permissao|2380:Dashboard.Graficos.Sobre\":\"Acesso\",\"permissao|2380:Dashboard.Relatorio.RelatorioCriacao\":\"Acesso\",\"permissao|2380:Dashboard.Relatorios.RelatorioAcessos\":[\"Acesso\",\"Alterar\",\"Excluir\",\"Novo\"],\"permissao|2380:Home\":\"Acesso\",\"permissao|2380:Noticias\":\"Acesso\",\"permissao|2380:Relatorios\":\"Acesso\",\"amr\":[\"password\"]}");
        var encodedIdentityToken = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6ImEzck1VZ01Gdjl0UGNsTGE2eUYzekFrZnF1RSIsIng1dCI6ImEzck1VZ01Gdjl0UGNsTGE2eUYzekFrZnF1RSJ9.eyJpc3MiOiJodHRwczovL3BqbXRzdHMvIiwiYXVkIjoiMjM4MCIsImV4cCI6MTQ2MTg4MjkzNSwibmJmIjoxNDYxODgyNjM1LCJub25jZSI6IjEyMjMwMjA2NTU5NDkyMDgiLCJpYXQiOjE0NjE4ODI2MzUsImF0X2hhc2giOiIzeV9iSi1oZEZiMjE3VHNpQUVpVnZ3IiwiY19oYXNoIjoibGhMRDFOaTNkcms0aEJKYXBQRUpaQSIsInNpZCI6IjNkMGQzNWYxNGFjYWQ3MzEyM2E2Y2FmMGU5NTY5NGIzIiwic3ViIjoiMTY4NDMiLCJhdXRoX3RpbWUiOjE0NjExNjQ5MzIsImlkcCI6Imlkc3J2IiwiYW1yIjpbInBhc3N3b3JkIl19.hS9vFGcUq6j3CBRsUDm2RG0zwyNbdRijN1L_f7EmX4d5o8Wxh9RaWxPmYUSAGt211lrnp1W0zm7HfWqOu3szJnhCWKfX_P9CYuc-3NyWXxL9iMZM07lzweunJeYrWM99KCWT9il_ptR3cvNBEZPBBHBmzQ5EPbHqMga35U3U0rHTuC1134qvDFE-2YoGyNXxP5KD-pyVlx0hPXOsfv9xYfKr9C31eEMqyyavZWpmiH8Ywz1vlJTMdX6Y9Gm7599Ojqe66mRAaDX7_rf8kecgvkSZD0uozHPGIX-Y8ORPS83AHXTOFOAXoO3hvxnJJ6iN1oVJSzWVsI59VFbvMIawCw";
        beforeEach(function () {
            SecurityContext_1.SecurityContext.Reset();
        });
        it('InitializeWithEncodedTokens should instantiate a Principal', function () {
            SecurityContextInitializer_1.SecurityContextInitializer.InitializeWithEncodedTokens([encodedAccessToken, encodedIdentityToken]);
            expect(SecurityContext_1.SecurityContext.Current.Principal).toBeDefined();
        });
        it('InitializeWithEncodedTokens should have a User authenticated', function () {
            SecurityContextInitializer_1.SecurityContextInitializer.InitializeWithEncodedTokens([encodedAccessToken, encodedIdentityToken]);
            expect(SecurityContext_1.SecurityContext.Current.Principal.IsAuthenticated).toBeTruthy();
        });
        it('InitializeWithTokens should instantiate a Principal', function () {
            SecurityContextInitializer_1.SecurityContextInitializer.InitializeWithTokens([accessToken]);
            expect(SecurityContext_1.SecurityContext.Current.Principal).toBeDefined();
        });
        it('InitializeWithTokens should have a User authenticated', function () {
            SecurityContextInitializer_1.SecurityContextInitializer.InitializeWithTokens([accessToken]);
            expect(SecurityContext_1.SecurityContext.Current.Principal.IsAuthenticated).toBeTruthy();
        });
        it('InitializeWithTokens should have a User authenticated', function () {
            SecurityContextInitializer_1.SecurityContextInitializer.InitializeWithTokens([{ name: 'João Vitor' }]);
            expect(SecurityContext_1.SecurityContext.Current.Principal.Identity.Name).toBe('João Vitor');
        });
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNwZWMvU2VjdXJpdHlDb250ZXh0SW5pdGlhbGl6ZXIuc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztJQUFBLDBEQUF1RDtJQUN2RCxnRkFBNkU7SUFFN0UsUUFBUSxDQUFDLDRCQUE0QixFQUFFO1FBRW5DLElBQU0sa0JBQWtCLEdBQVUsZzRDQUFnNEMsQ0FBQztRQUVuNkMsSUFBTSxXQUFXLEdBQU8sSUFBSSxDQUFDLEtBQUssQ0FBQywrd0JBQTJyQixDQUFDLENBQUM7UUFFaHVCLElBQU0sb0JBQW9CLEdBQVUsMDJCQUEwMkIsQ0FBQztRQUdqNUIsVUFBVSxDQUFDO1lBQ1AsaUNBQWUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUMxQixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw0REFBNEQsRUFBRTtZQUU3RCx1REFBMEIsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLGtCQUFrQixFQUFFLG9CQUFvQixDQUFDLENBQUMsQ0FBQztZQUVuRyxNQUFNLENBQUMsaUNBQWUsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFNUQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsOERBQThELEVBQUU7WUFFL0QsdURBQTBCLENBQUMsMkJBQTJCLENBQUMsQ0FBQyxrQkFBa0IsRUFBRSxvQkFBb0IsQ0FBQyxDQUFDLENBQUM7WUFFbkcsTUFBTSxDQUFDLGlDQUFlLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUUzRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxxREFBcUQsRUFBRTtZQUV0RCx1REFBMEIsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFFL0QsTUFBTSxDQUFDLGlDQUFlLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBRTVELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHVEQUF1RCxFQUFFO1lBRXhELHVEQUEwQixDQUFDLG9CQUFvQixDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztZQUUvRCxNQUFNLENBQUMsaUNBQWUsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBRTNFLENBQUMsQ0FBQyxDQUFDO1FBR0gsRUFBRSxDQUFDLHVEQUF1RCxFQUFFO1lBRXhELHVEQUEwQixDQUFDLG9CQUFvQixDQUFFLENBQUUsRUFBRSxJQUFJLEVBQUMsWUFBWSxFQUFFLENBQUUsQ0FBRSxDQUFDO1lBRTdFLE1BQU0sQ0FBQyxpQ0FBZSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUUvRSxDQUFDLENBQUMsQ0FBQztJQUVQLENBQUMsQ0FBQyxDQUFDIiwiZmlsZSI6InNwZWMvU2VjdXJpdHlDb250ZXh0SW5pdGlhbGl6ZXIuc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7U2VjdXJpdHlDb250ZXh0fSBmcm9tICcuLi9zcmMvU2VjdXJpdHlDb250ZXh0JztcclxuaW1wb3J0IHtTZWN1cml0eUNvbnRleHRJbml0aWFsaXplcn0gZnJvbSAnLi4vc3JjL1NlY3VyaXR5Q29udGV4dEluaXRpYWxpemVyJztcclxuXHJcbmRlc2NyaWJlKCdTZWN1cml0eUNvbnRleHRJbml0aWFsaXplcicsICgpID0+IHtcclxuICAgIFxyXG4gICAgY29uc3QgZW5jb2RlZEFjY2Vzc1Rva2VuOnN0cmluZyA9IFwiZXlKMGVYQWlPaUpLVjFRaUxDSmhiR2NpT2lKU1V6STFOaUlzSW10cFpDSTZJbUV6Y2sxVlowMUdkamwwVUdOc1RHRTJlVVl6ZWtGclpuRjFSU0lzSW5nMWRDSTZJbUV6Y2sxVlowMUdkamwwVUdOc1RHRTJlVVl6ZWtGclpuRjFSU0o5LmV5SnBjM01pT2lKb2RIUndjem92TDNCcWJYUnpkSE12SWl3aVlYVmtJam9pYUhSMGNITTZMeTl3YW0xMGMzUnpMM0psYzI5MWNtTmxjeUlzSW1WNGNDSTZNVFEyTVRnNE5qSXpOU3dpYm1KbUlqb3hORFl4T0RneU5qTTFMQ0pqYkdsbGJuUmZhV1FpT2lJeU16Z3dJaXdpYzJOdmNHVWlPbHNpYjNCbGJtbGtJaXdpY0hKdlptbHNaU0lzSW1WdFlXbHNJaXdpY0dwdGRGOXdjbTltYVd4bElpd2ljR1Z5YldsemMyRnZYekl6T0RBaVhTd2ljM1ZpSWpvaU1UWTRORE1pTENKaGRYUm9YM1JwYldVaU9qRTBOakV4TmpRNU16SXNJbWxrY0NJNkltbGtjM0oySWl3aWNHVnliV2x6YzJGdmZESXpPREE2UkdGemFHSnZZWEprSWpvaVFXTmxjM052SWl3aWNHVnliV2x6YzJGdmZESXpPREE2UkdGemFHSnZZWEprTGtkeVlXWnBZMjl6SWpvaVFXTmxjM052SWl3aWNHVnliV2x6YzJGdmZESXpPREE2UkdGemFHSnZZWEprTGtkeVlXWnBZMjl6TGtScGRtVnljMjl6SWpvaVFXTmxjM052SWl3aWNHVnliV2x6YzJGdmZESXpPREE2UkdGemFHSnZZWEprTGtkeVlXWnBZMjl6TGxOdlluSmxJam9pUVdObGMzTnZJaXdpY0dWeWJXbHpjMkZ2ZkRJek9EQTZSR0Z6YUdKdllYSmtMbEpsYkdGMGIzSnBieTVTWld4aGRHOXlhVzlEY21saFkyRnZJam9pUVdObGMzTnZJaXdpY0dWeWJXbHpjMkZ2ZkRJek9EQTZSR0Z6YUdKdllYSmtMbEpsYkdGMGIzSnBiM011VW1Wc1lYUnZjbWx2UVdObGMzTnZjeUk2V3lKQlkyVnpjMjhpTENKQmJIUmxjbUZ5SWl3aVJYaGpiSFZwY2lJc0lrNXZkbThpWFN3aWNHVnliV2x6YzJGdmZESXpPREE2U0c5dFpTSTZJa0ZqWlhOemJ5SXNJbkJsY20xcGMzTmhiM3d5TXpnd09rNXZkR2xqYVdGeklqb2lRV05sYzNOdklpd2ljR1Z5YldsemMyRnZmREl6T0RBNlVtVnNZWFJ2Y21sdmN5STZJa0ZqWlhOemJ5SXNJbUZ0Y2lJNld5SndZWE56ZDI5eVpDSmRmUS5FZy1iZFBBSEtNSURsVk1pR05KeEVKOXpxdGgyVW1VLWswRWsxQkl0aEM2V0tuZnlGT1E3RVFYSWJRR0JyTGhtNENIcl9zaXdyZ1RoQUw1TnEzR0pBbzBfd3hmamdkZ3Q5NjVGSFpMTzBYYS1RUlR2Zldkd0NVN19qSFlqbHd1eUo4SURpRXBRZjZ5NmVlVUlNeFJJMEpaYS1hSXJ0NU10TUNyTU1lY1RkVVJYRjkxYlhCRmROREpTR0xwcXJmNjg3SHV6VUNIcnJ6bkJyNndPLTUtNVkyNHJucFRiRWNsUzlLREpZdVRab0JRQTYtVGtjeV9YQkhnNGMxd2h3d09SZjlOZnYxYzhfVjZaak1MMWVpcWRsSzdNRGpxbXNaYkFaa1Njckp6Wm14cG9CTWt2QU1ESWhrbUI4WlZzR2tyWUlDcXRyQVI2Qkl1VGsyYUszejhsb3dcIjtcclxuICAgIFxyXG4gICAgY29uc3QgYWNjZXNzVG9rZW46YW55ID0gSlNPTi5wYXJzZShge1wiaXNzXCI6XCJodHRwczovL3BqbXRzdHMvXCIsXCJhdWRcIjpcImh0dHBzOi8vcGptdHN0cy9yZXNvdXJjZXNcIixcImV4cFwiOjE0NjI0MDM1ODIsXCJuYmZcIjoxNDYyMzk5OTgyLFwiY2xpZW50X2lkXCI6XCIyMzgwXCIsXCJzY29wZVwiOltcIm9wZW5pZFwiLFwicHJvZmlsZVwiLFwicGptdF9wcm9maWxlXCIsXCJlbWFpbFwiLFwicGVybWlzc2FvXzIzODBcIl0sXCJzdWJcIjpcIjE2ODQzXCIsXCJhdXRoX3RpbWVcIjoxNDYyMzk3MDQyLFwiaWRwXCI6XCJpZHNydlwiLFwicGVybWlzc2FvfDIzODA6RGFzaGJvYXJkXCI6XCJBY2Vzc29cIixcInBlcm1pc3Nhb3wyMzgwOkRhc2hib2FyZC5HcmFmaWNvc1wiOlwiQWNlc3NvXCIsXCJwZXJtaXNzYW98MjM4MDpEYXNoYm9hcmQuR3JhZmljb3MuRGl2ZXJzb3NcIjpcIkFjZXNzb1wiLFwicGVybWlzc2FvfDIzODA6RGFzaGJvYXJkLkdyYWZpY29zLlNvYnJlXCI6XCJBY2Vzc29cIixcInBlcm1pc3Nhb3wyMzgwOkRhc2hib2FyZC5SZWxhdG9yaW8uUmVsYXRvcmlvQ3JpYWNhb1wiOlwiQWNlc3NvXCIsXCJwZXJtaXNzYW98MjM4MDpEYXNoYm9hcmQuUmVsYXRvcmlvcy5SZWxhdG9yaW9BY2Vzc29zXCI6W1wiQWNlc3NvXCIsXCJBbHRlcmFyXCIsXCJFeGNsdWlyXCIsXCJOb3ZvXCJdLFwicGVybWlzc2FvfDIzODA6SG9tZVwiOlwiQWNlc3NvXCIsXCJwZXJtaXNzYW98MjM4MDpOb3RpY2lhc1wiOlwiQWNlc3NvXCIsXCJwZXJtaXNzYW98MjM4MDpSZWxhdG9yaW9zXCI6XCJBY2Vzc29cIixcImFtclwiOltcInBhc3N3b3JkXCJdfWApO1xyXG5cclxuICAgIGNvbnN0IGVuY29kZWRJZGVudGl0eVRva2VuOnN0cmluZyA9IFwiZXlKMGVYQWlPaUpLVjFRaUxDSmhiR2NpT2lKU1V6STFOaUlzSW10cFpDSTZJbUV6Y2sxVlowMUdkamwwVUdOc1RHRTJlVVl6ZWtGclpuRjFSU0lzSW5nMWRDSTZJbUV6Y2sxVlowMUdkamwwVUdOc1RHRTJlVVl6ZWtGclpuRjFSU0o5LmV5SnBjM01pT2lKb2RIUndjem92TDNCcWJYUnpkSE12SWl3aVlYVmtJam9pTWpNNE1DSXNJbVY0Y0NJNk1UUTJNVGc0TWprek5Td2libUptSWpveE5EWXhPRGd5TmpNMUxDSnViMjVqWlNJNklqRXlNak13TWpBMk5UVTVORGt5TURnaUxDSnBZWFFpT2pFME5qRTRPREkyTXpVc0ltRjBYMmhoYzJnaU9pSXplVjlpU2kxb1pFWmlNakUzVkhOcFFVVnBWblozSWl3aVkxOW9ZWE5vSWpvaWJHaE1SREZPYVROa2NtczBhRUpLWVhCUVJVcGFRU0lzSW5OcFpDSTZJak5rTUdRek5XWXhOR0ZqWVdRM016RXlNMkUyWTJGbU1HVTVOVFk1TkdJeklpd2ljM1ZpSWpvaU1UWTRORE1pTENKaGRYUm9YM1JwYldVaU9qRTBOakV4TmpRNU16SXNJbWxrY0NJNkltbGtjM0oySWl3aVlXMXlJanBiSW5CaGMzTjNiM0prSWwxOS5oUzl2RkdjVXE2ajNDQlJzVURtMlJHMHp3eU5iZFJpak4xTF9mN0VtWDRkNW84V3hoOVJhV3hQbVlVU0FHdDIxMWxybnAxVzB6bTdIZldxT3Uzc3pKbmhDV0tmWF9QOUNZdWMtM055V1h4TDlpTVpNMDdsendldW5KZVlyV005OUtDV1Q5aWxfcHRSM2N2TkJFWlBCQkhCbXpRNUVQYkhxTWdhMzVVM1UwckhUdUMxMTM0cXZERkUtMllvR3lOWHhQNUtELXB5Vmx4MGhQWE9zZnY5eFlmS3I5QzMxZUVNcXl5YXZaV3BtaUg4WXd6MXZsSlRNZFg2WTlHbTc1OTlPanFlNjZtUkFhRFg3X3JmOGtlY2d2a1NaRDB1b3pIUEdJWC1ZOE9SUFM4M0FIWFRPRk9BWG9PM2h2eG5KSjZpTjFvVkpTeldWc0k1OVZGYnZNSWF3Q3dcIjtcclxuICAgIFxyXG4gICAgXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgIFNlY3VyaXR5Q29udGV4dC5SZXNldCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ0luaXRpYWxpemVXaXRoRW5jb2RlZFRva2VucyBzaG91bGQgaW5zdGFudGlhdGUgYSBQcmluY2lwYWwnLCAoKSA9PiB7XHJcbiAgICBcclxuICAgICAgICBTZWN1cml0eUNvbnRleHRJbml0aWFsaXplci5Jbml0aWFsaXplV2l0aEVuY29kZWRUb2tlbnMoW2VuY29kZWRBY2Nlc3NUb2tlbiwgZW5jb2RlZElkZW50aXR5VG9rZW5dKTtcclxuICAgICAgICBcclxuICAgICAgICBleHBlY3QoU2VjdXJpdHlDb250ZXh0LkN1cnJlbnQuUHJpbmNpcGFsKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgaXQoJ0luaXRpYWxpemVXaXRoRW5jb2RlZFRva2VucyBzaG91bGQgaGF2ZSBhIFVzZXIgYXV0aGVudGljYXRlZCcsICgpID0+IHtcclxuICAgICAgICBcclxuICAgICAgICBTZWN1cml0eUNvbnRleHRJbml0aWFsaXplci5Jbml0aWFsaXplV2l0aEVuY29kZWRUb2tlbnMoW2VuY29kZWRBY2Nlc3NUb2tlbiwgZW5jb2RlZElkZW50aXR5VG9rZW5dKTtcclxuICAgICAgICBcclxuICAgICAgICBleHBlY3QoU2VjdXJpdHlDb250ZXh0LkN1cnJlbnQuUHJpbmNpcGFsLklzQXV0aGVudGljYXRlZCkudG9CZVRydXRoeSgpO1xyXG4gICAgXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgaXQoJ0luaXRpYWxpemVXaXRoVG9rZW5zIHNob3VsZCBpbnN0YW50aWF0ZSBhIFByaW5jaXBhbCcsICgpID0+IHtcclxuICAgIFxyXG4gICAgICAgIFNlY3VyaXR5Q29udGV4dEluaXRpYWxpemVyLkluaXRpYWxpemVXaXRoVG9rZW5zKFthY2Nlc3NUb2tlbl0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cGVjdChTZWN1cml0eUNvbnRleHQuQ3VycmVudC5QcmluY2lwYWwpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICBcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpdCgnSW5pdGlhbGl6ZVdpdGhUb2tlbnMgc2hvdWxkIGhhdmUgYSBVc2VyIGF1dGhlbnRpY2F0ZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgU2VjdXJpdHlDb250ZXh0SW5pdGlhbGl6ZXIuSW5pdGlhbGl6ZVdpdGhUb2tlbnMoW2FjY2Vzc1Rva2VuXSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwZWN0KFNlY3VyaXR5Q29udGV4dC5DdXJyZW50LlByaW5jaXBhbC5Jc0F1dGhlbnRpY2F0ZWQpLnRvQmVUcnV0aHkoKTtcclxuICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgaXQoJ0luaXRpYWxpemVXaXRoVG9rZW5zIHNob3VsZCBoYXZlIGEgVXNlciBhdXRoZW50aWNhdGVkJywgKCkgPT4ge1xyXG4gICAgICAgIFxyXG4gICAgICAgIFNlY3VyaXR5Q29udGV4dEluaXRpYWxpemVyLkluaXRpYWxpemVXaXRoVG9rZW5zKCBbIHsgbmFtZTonSm/Do28gVml0b3InIH0gXSApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cGVjdChTZWN1cml0eUNvbnRleHQuQ3VycmVudC5QcmluY2lwYWwuSWRlbnRpdHkuTmFtZSkudG9CZSgnSm/Do28gVml0b3InKTtcclxuICAgIFxyXG4gICAgfSk7XHJcbiAgICBcclxufSk7XHJcbiJdfQ==
